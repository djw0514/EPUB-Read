# 需求文档

## 简介

EPUB 在线阅读器是一个基于 Web 的电子书阅读应用程序，支持 EPUB 格式文件的在线阅读。该应用提供了丰富的阅读体验，包括文字和图片显示、字体调整、背景主题切换、双页/单页模式、鼠标滚轮翻页以及书架管理等功能。

## 术语表

- **EPUB**: 电子出版物（Electronic Publication）的缩写，是一种开放的电子书标准格式
- **Rendition**: ePub.js 库中用于渲染电子书内容的对象
- **TOC**: 目录（Table of Contents）的缩写
- **CFI**: 规范片段标识符（Canonical Fragment Identifier），用于定位 EPUB 内容中的特定位置
- **Spine**: EPUB 文件中定义阅读顺序的结构
- **阅读器**: 指整个 EPUB 在线阅读器应用程序
- **书架**: 用户存储和管理已导入电子书的功能模块
- **面板**: 指目录面板、设置面板和书架面板等侧边栏界面

## 需求

### 需求 1：文件导入与加载

**用户故事：** 作为用户，我希望能够导入 EPUB 格式的电子书文件，以便在浏览器中阅读电子书内容。

#### 验收标准

1. WHEN 用户点击导入按钮或拖拽 EPUB 文件到上传区域 THEN 阅读器 SHALL 加载该电子书文件
2. WHEN 用户选择非 EPUB 格式文件 THEN 阅读器 SHALL 显示错误提示信息
3. WHEN 电子书加载成功 THEN 阅读器 SHALL 显示电子书内容并隐藏上传区域
4. WHEN 电子书加载失败 THEN 阅读器 SHALL 显示错误提示信息
5. WHEN 电子书加载完成 THEN 阅读器 SHALL 提取书籍元数据（标题、作者、封面）

### 需求 2：阅读导航

**用户故事：** 作为用户，我希望能够方便地在电子书中导航，以便快速找到想要阅读的内容。

#### 验收标准

1. WHEN 用户点击上一页按钮或使用鼠标向上滚动 THEN 阅读器 SHALL 显示上一页内容
2. WHEN 用户点击下一页按钮或使用鼠标向下滚动 THEN 阅读器 SHALL 显示下一页内容
3. WHEN 用户在当前章节的第一页继续向前翻页 THEN 阅读器 SHALL 跳转到上一章节
4. WHEN 用户在当前章节的最后一页继续向后翻页 THEN 阅读器 SHALL 跳转到下一章节
5. WHEN 用户点击目录中的章节 THEN 阅读器 SHALL 跳转到对应章节
6. WHEN 用户使用键盘方向键 THEN 阅读器 SHALL 响应翻页操作

### 需求 3：目录功能

**用户故事：** 作为用户，我希望能够查看电子书的目录结构，以便快速定位到特定章节。

#### 验收标准

1. WHEN 用户点击目录按钮 THEN 阅读器 SHALL 显示目录面板
2. WHEN 电子书包含目录信息 THEN 阅读器 SHALL 在目录面板中显示章节列表
3. WHEN 电子书包含多级目录 THEN 阅读器 SHALL 以层级结构显示目录
4. WHEN 电子书不包含目录信息 THEN 阅读器 SHALL 显示提示信息
5. WHEN 用户点击目录项 THEN 阅读器 SHALL 跳转到对应章节并关闭目录面板

### 需求 4：阅读设置

**用户故事：** 作为用户，我希望能够自定义阅读界面，以便获得更舒适的阅读体验。

#### 验收标准

1. WHEN 用户调整字体大小 THEN 阅读器 SHALL 实时更新电子书内容的字体大小
2. WHEN 用户选择字体样式 THEN 阅读器 SHALL 应用选定的字体到电子书内容
3. WHEN 用户选择预设主题（亮色、护眼、深色、绿意） THEN 阅读器 SHALL 应用对应的背景色和文字颜色
4. WHEN 用户自定义背景色和文字颜色 THEN 阅读器 SHALL 应用自定义颜色
5. WHEN 用户调整行距 THEN 阅读器 SHALL 实时更新电子书内容的行距
6. WHEN 用户调整页边距 THEN 阅读器 SHALL 实时更新电子书内容的页边距
7. WHEN 用户调整亮度 THEN 阅读器 SHALL 实时更新阅读区域的亮度
8. WHEN 用户切换显示模式（单页/双页） THEN 阅读器 SHALL 重新渲染电子书内容

### 需求 5：书架管理

**用户故事：** 作为用户，我希望能够管理已导入的电子书，以便快速访问和组织我的电子书收藏。

#### 验收标准

1. WHEN 用户成功加载电子书 THEN 阅读器 SHALL 自动将该书添加到书架
2. WHEN 用户打开书架面板 THEN 阅读器 SHALL 显示所有已导入的电子书列表
3. WHEN 书架中存在电子书 THEN 阅读器 SHALL 显示书籍封面、标题、作者和阅读进度
4. WHEN 用户点击书架中的电子书 THEN 阅读器 SHALL 加载该电子书并恢复上次阅读位置
5. WHEN 用户删除书架中的电子书 THEN 阅读器 SHALL 从书架中移除该书
6. WHEN 用户关闭并重新打开应用 THEN 阅读器 SHALL 保留书架中的所有电子书

### 需求 6：阅读进度

**用户故事：** 作为用户，我希望系统能够记录我的阅读进度，以便下次继续阅读时从上次停止的位置开始。

#### 验收标准

1. WHEN 用户翻页 THEN 阅读器 SHALL 更新进度条显示
2. WHEN 用户翻页 THEN 阅读器 SHALL 保存当前阅读位置
3. WHEN 用户重新打开已读过的电子书 THEN 阅读器 SHALL 从上次阅读位置继续
4. WHEN 用户查看书架 THEN 阅读器 SHALL 显示每本书的阅读进度百分比
5. WHEN 用户阅读电子书 THEN 阅读器 SHALL 实时更新书架中该书的阅读进度

### 需求 7：页面信息显示

**用户故事：** 作为用户，我希望能够看到当前的页码信息，以便了解阅读进度。

#### 验收标准

1. WHEN 电子书加载完成 THEN 阅读器 SHALL 在工具栏中显示当前页码和总页数
2. WHEN 用户翻页 THEN 阅读器 SHALL 实时更新页码信息
3. WHEN 用户切换章节 THEN 阅读器 SHALL 更新页码信息
4. WHEN 没有加载电子书 THEN 阅读器 SHALL 显示 "0 / 0"

### 需求 8：用户界面交互

**用户故事：** 作为用户，我希望界面操作简单直观，以便快速访问各项功能。

#### 验收标准

1. WHEN 用户点击设置按钮 THEN 阅读器 SHALL 显示或隐藏设置面板
2. WHEN 用户点击目录按钮 THEN 阅读器 SHALL 显示或隐藏目录面板
3. WHEN 用户点击书架按钮 THEN 阅读器 SHALL 显示或隐藏书架面板
4. WHEN 用户点击面板外部区域 THEN 阅读器 SHALL 关闭当前打开的面板
5. WHEN 用户点击面板关闭按钮 THEN 阅读器 SHALL 关闭对应面板
6. WHEN 用户执行操作 THEN 阅读器 SHALL 提供视觉反馈（按钮高亮、动画效果等）

### 需求 9：响应式设计

**用户故事：** 作为用户，我希望应用能够在不同设备上正常使用，以便在手机、平板和电脑上都能阅读电子书。

#### 验收标准

1. WHEN 用户在移动设备上访问应用 THEN 阅读器 SHALL 调整界面布局以适应小屏幕
2. WHEN 用户在平板设备上访问应用 THEN 阅读器 SHALL 提供适合平板的界面布局
3. WHEN 用户在桌面设备上访问应用 THEN 阅读器 SHALL 提供完整的桌面界面
4. WHEN 用户调整浏览器窗口大小 THEN 阅读器 SHALL 动态调整界面布局

### 需求 10：数据持久化

**用户故事：** 作为用户，我希望我的设置和书架数据能够被保存，以便下次使用时保持一致的体验。

#### 验收标准

1. WHEN 用户修改阅读设置 THEN 阅读器 SHALL 将设置保存到本地存储
2. WHEN 用户添加电子书到书架 THEN 阅读器 SHALL 将书籍数据保存到本地存储
3. WHEN 用户重新打开应用 THEN 阅读器 SHALL 从本地存储加载设置和书架数据
4. WHEN 用户删除书架中的电子书 THEN 阅读器 SHALL 从本地存储中删除对应数据
5. WHEN 用户更新阅读进度 THEN 阅读器 SHALL 将进度保存到本地存储
